define(['jsonic/jsonic-min'], function () {
  function render () {
    $('div[data-code-plugin-orgchart]').each(function (index, el) {
      var $el = $(el)
      try {
        var code = jsonic($.decodeHTML($el.html()), false)
        $el
          .html('').addClass('code-plugin-orgchart')
          .attr('data-code-plugin-orgchart', null)
          .attr('data-code-plugin-params', null)
        $el.orgchart({
          data: code,
          depth: 2,
          nodeContent: 'desc'
        })
        $el.show()
      } catch (e) {
        $el.html(e)
        $el.show()
      }
    })
  }
  require([
    'orgchart/dist/js/jquery.orgchart.min',
    'require-css/css!orgchart/dist/css/jquery.orgchart.min'
  ], function () {
    render()
  })
})
