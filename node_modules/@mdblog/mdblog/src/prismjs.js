/* eslint-disable camelcase */
define([
  'jquery/dist/jquery.min',
  'prismjs/prism'
], function ($, Prism) {
  'use strict'

  var defer = $.Deferred()
  require([
    'prismjs/plugins/toolbar/prism-toolbar.min',
    'prismjs/plugins/autoloader/prism-autoloader.min',
    'prismjs/plugins/line-numbers/prism-line-numbers.min',
    'require-css/css!prismjs/themes/prism-dark',
    'require-css/css!prismjs/plugins/toolbar/prism-toolbar',
    'require-css/css!prismjs/plugins/line-numbers/prism-line-numbers'
  ], function () {
    Prism.plugins.autoloader.languages_path = '/node_modules/prismjs/components/'
    require(['prismjs/plugins/show-language/prism-show-language.min'], function () {
      defer.resolve()
    })
  })
  var highlightAll = Prism.highlightAll
  Prism.highlightAll = function () {
    defer.then(function () {
      highlightAll.apply(Prism, arguments)
    })
  }

  return Prism
});
