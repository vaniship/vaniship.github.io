# 自动生成路由的几种实现方案

## 借助自定义 webpack loader

基本原理：

优势：

* 基于源代码生成，灵活性好
* 支持灵活配置 chunkName
* 支持处理 ``.vue`` 文件的自定义块
* 生成代码不落盘，效率较高

不便：

* 需要修改 webpack 配置，添加一个特定的 loader 配置，可简化配置
  * vue 借助 vue 的构建插件体系
  * react 借助 react-app-rewired 配置
* 生成的文件略大（和 webpack require.context相比）
  * 和手工配置相比，基本相同（因为原理是自动代码生成）
* 对 jest 单元测试支持不好，仅带路由页面受影响

## 借助 webpack hooks

基本原理：

优势：

* 基于源代码生成，灵活性好
* 一定程度上对 jest 单元测试支持较好

存在问题：

* 生成代码每次落盘，效率较低
* 如果要支持处理 ``.vue`` 文件的自定义块，依然需要自定义 loader

## 借助 webpack require.context

基本原理：

优势：

* 不用修改 webpack 配置

存在的问题：

* 基于代码转换，灵活性受限（相对于源代码生成）
* 不便处理 ``.vue`` 文件的自定义块，如额外的路由配置
  * 可借助在 script 中导出特殊变量代替，但是路由配置应该独立于路由页面，放在一起会导致在导入路由配置时就将页面代码也一并导入，无法按需加载
  * 或使用附加文件，破坏了 vue 的单文件组件理念
* 无法自定义 chunk 名称
* 对 jest 单元测试支持不好，仅带路由页面受影响
